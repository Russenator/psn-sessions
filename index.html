<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Sessions / Timezone Planner</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/de.js"></script>
<style>
  body {
    font-family: Inter, sans-serif;
    background: var(--bg);
    color: var(--text);
    margin: 0;
    padding: 20px;
    transition: background 0.3s, color 0.3s;
  }
  :root {
    --bg: #ffffff;
    --text: #111;
    --card: #f5f5f5;
  }
  .dark {
    --bg: #111;
    --text: #eee;
    --card: #222;
  }
  h1 {
    text-align: center;
  }
  .card {
    background: var(--card);
    padding: 15px;
    border-radius: 12px;
    max-width: 450px;
    margin: 0 auto 20px auto;
    box-shadow: 0 4px 12px #0002;
  }
  input, select, button {
    width: 100%;
    padding: 10px;
    margin-top: 8px;
    border-radius: 8px;
    border: 1px solid #ccc;
    background: var(--bg);
    color: var(--text);
  }
  .session {
    background: var(--card);
    padding: 10px;
    border-radius: 8px;
    margin-bottom: 10px;
    position: relative;
  }
  .deleteBtn {
    position: absolute;
    right: 10px;
    top: 10px;
    cursor: pointer;
    font-weight: bold;
    padding: 4px 8px;
    border-radius: 6px;
    background: #d33;
    color: #fff;
  }
</style>
</head>
<body>
<button id="themeToggle">Dark/Light</button>
<h1>Sessions Planner</h1>

<div class="card">
  <label>Datum:</label>
  <input id="dateInput" placeholder="Datum auswählen" />

  <label>Uhrzeit:</label>
  <input id="timeInput" placeholder="z.B. 18:30 oder 6:30 PM" />

  <label>UTC Offset:</label>
  <input id="utcInput" />

  <button id="addBtn">Session hinzufügen</button>
</div>

<h2>Alle Sessions</h2>
<div id="sessionList"></div>

<script>
// ---------- THEME ----------
const root = document.documentElement;
document.getElementById("themeToggle").onclick = () => {
  root.classList.toggle("dark");
};

// ---------- AUTO UTC ----------
function getAutoUTC() {
  const offset = -new Date().getTimezoneOffset() / 60;
  return (offset >= 0 ? "+" : "") + offset;
}
document.getElementById("utcInput").value = "UTC" + getAutoUTC();

// ---------- DATE PICKER ----------
flatpickr("#dateInput", {
  locale: "de",
  dateFormat: "d.m.Y",
});

// ---------- SAVE & LOAD ----------
let sessions = JSON.parse(localStorage.getItem("sessions") || "[]");
render();

function render() {
  const list = document.getElementById("sessionList");
  list.innerHTML = "";
  sessions.forEach((s, i) => {
    const div = document.createElement("div");
    div.className = "session";
    div.innerHTML = `${s.date} – ${s.time} (${s.utc}) <span class="deleteBtn" data-i="${i}">X</span>`;
    list.appendChild(div);
  });
  document.querySelectorAll(".deleteBtn").forEach(btn => {
    btn.onclick = () => {
      const key = prompt("Admin-Key eingeben zum Löschen:");
      if (key === "MEIN_GEHEIM_KEY") {
        sessions.splice(btn.dataset.i, 1);
        save();
      } else alert("Falscher Key!");
    };
  });
}

function save() {
  localStorage.setItem("sessions", JSON.stringify(sessions));
  render();
}

// ---------- ADD SESSION ----------
document.getElementById("addBtn").onclick = () => {
  const d = dateInput.value;
  const t = timeInput.value;
  const u = utcInput.value;
  if (!d || !t) return alert("Bitte Datum und Uhrzeit eingeben");
  sessions.push({ date: d, time: t, utc: u });
  save();
};
</script>
</body>
</html>
